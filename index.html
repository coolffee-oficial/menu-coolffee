<!DOCTYPE html>
<html lang="es">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>COOLFFEE - MenÃº</title>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:ital,wght@0,700;1,700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
Â  Â  <style>
Â  Â  Â  Â  :root { --brand-gold: #c29957; --line-red: #bc2c2c; --bg: #030303; --card-bg: #111; --text-product: #d1d1d1; --text-dim: #888; }
Â  Â  Â  Â  body { background-color: var(--bg); color: #fff; font-family: 'Inter', sans-serif; margin: 0; padding: 0; display: flex; justify-content: center; }
Â  Â  Â  Â  .app-container { width: 100%; max-width: 480px; padding: 20px 20px 120px; box-sizing: border-box; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .header-section { text-align: center; margin: 40px 0 30px; }
Â  Â  Â  Â  .header-section h1 { font-family: 'Barlow Condensed', sans-serif; font-style: italic; font-weight: 700; color: var(--brand-gold); font-size: 3.2rem; margin: 0; text-transform: uppercase; letter-spacing: 2px; }
Â  Â  Â  Â  .red-bar { width: 100%; height: 2px; background-color: var(--line-red); margin-top: 5px; }

Â  Â  Â  Â  .category-title { font-family: 'Barlow Condensed', sans-serif; font-style: italic; font-weight: 700; color: var(--brand-gold); font-size: 1.6rem; margin: 35px 0 15px; text-transform: uppercase; border-bottom: 1px solid #1a1a1a; padding-bottom: 5px; }
Â  Â  Â  Â  .product { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; gap: 10px; }
Â  Â  Â  Â  .p-info { flex: 1; }
Â  Â  Â  Â  .p-info h3 { margin: 0; font-size: 1.05rem; color: var(--text-product); font-weight: 700; text-transform: uppercase; }
Â  Â  Â  Â  .p-info p { margin: 3px 0 0; font-size: 0.8rem; color: var(--text-dim); line-height: 1.2; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .p-prices { display: flex; gap: 8px; flex-shrink: 0; }
Â  Â  Â  Â  .p-opt { color: #fff; font-size: 0.85rem; cursor: pointer; border: 1px solid #333; width: 75px; height: 38px; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 6px; background: #111; transition: 0.2s; line-height: 1; }
Â  Â  Â  Â  .p-opt:active { transform: scale(0.95); background: #222; }
Â  Â  Â  Â  .p-opt span { color: var(--brand-gold); font-weight: bold; margin-top: 2px; }
Â  Â  Â  Â  .p-opt small { font-size: 0.65rem; color: var(--text-dim); text-transform: uppercase; }

Â  Â  Â  Â  #view-cart-btn { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; background: var(--brand-gold); color: #000; padding: 15px; border-radius: 50px; text-align: center; font-weight: 800; cursor: pointer; display: none; z-index: 999; box-shadow: 0 5px 20px rgba(0,0,0,0.5); text-transform: uppercase; }

Â  Â  Â  Â  .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); display: none; z-index: 1001; }
Â  Â  Â  Â  .modal-content { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 480px; background: var(--card-bg); border-top: 3px solid var(--brand-gold); border-radius: 25px 25px 0 0; padding: 25px; box-sizing: border-box; max-height: 90vh; overflow-y: auto; color: #fff; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #222; }
Â  Â  Â  Â  .qty-controls { display: flex; align-items: center; gap: 15px; }
Â  Â  Â  Â  .qty-btn { background: transparent; border: 1px solid var(--brand-gold); color: var(--brand-gold); width: 28px; height: 28px; border-radius: 50%; font-weight: bold; cursor: pointer; }

Â  Â  Â  Â  .form-group { margin-top: 18px; }
Â  Â  Â  Â  .form-group label { display: block; font-size: 0.7rem; color: var(--brand-gold); text-transform: uppercase; margin-bottom: 6px; letter-spacing: 1px; }
Â  Â  Â  Â  .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; background: #000; border: 1px solid #333; color: #fff; border-radius: 8px; font-family: inherit; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .delivery-notice { font-size: 0.75rem; color: var(--brand-gold); margin-top: 8px; font-style: italic; border-left: 2px solid var(--line-red); padding-left: 10px; }

Â  Â  Â  Â  .main-btn { background: var(--brand-gold); color: #000; padding: 16px; border-radius: 50px; border: none; width: 100%; font-weight: 800; text-transform: uppercase; margin-top: 25px; cursor: pointer; }
Â  Â  Â  Â  .secondary-btn { background: none; border: none; color: var(--text-dim); width: 100%; margin-top: 15px; cursor: pointer; text-transform: uppercase; font-size: 0.75rem; }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="app-container">
Â  Â  Â  Â  <div class="header-section">
Â  Â  Â  Â  Â  Â  <h1>COOLFFEE</h1>
Â  Â  Â  Â  Â  Â  <div class="red-bar"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="menu-content">Cargando menÃº...</div>
Â  Â  </div>

Â  Â  <div id="view-cart-btn" onclick="openModal('cart')">Ver Pedido (<span id="btn-qty">0</span>) - $<span id="btn-total">0.00</span></div>

Â  Â  <div class="modal-overlay" id="modal-overlay">
Â  Â  Â  Â  <div class="modal-content">
Â  Â  Â  Â  Â  Â  <div id="step-cart">
Â  Â  Â  Â  Â  Â  Â  Â  <h2 style="color:var(--brand-gold); text-transform:uppercase; margin-top:0;">Resumen</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="cart-list"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="text-align:right; font-size:1.4rem; margin: 20px 0; font-weight:700;">TOTAL: <span style="color:var(--brand-gold)">$<span id="modal-total">0.00</span></span></div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="main-btn" onclick="openModal('form')">Confirmar Pedido</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="secondary-btn" onclick="closeModal()">+ Agregar mÃ¡s productos</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="step-form" style="display:none;">
Â  Â  Â  Â  Â  Â  Â  Â  <h2 style="color:var(--brand-gold); text-transform:uppercase; margin-top:0;">Datos de Entrega</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group"><label>Nombre y Apellido</label><input type="text" id="c-nombre"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group"><label>CÃ©dula</label><input type="number" id="c-cedula"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group"><label>TelÃ©fono</label><input type="tel" id="c-telefono"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Tipo de Entrega</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="c-entrega" onchange="toggleDeliveryFields(this.value)">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Pick Up">Pick Up (Retiro en local)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Delivery">Delivery</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="div-dir" style="display:none">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="delivery-notice">El costo del delivery serÃ¡ calculado por distancia.</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group"><label>DirecciÃ³n</label><textarea id="c-direccion"></textarea></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="secondary-btn" style="color:#fff; border:1px solid #333; padding:10px; border-radius:8px;" onclick="getGPS()">ğŸ“ Adjuntar UbicaciÃ³n GPS</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="hidden" id="c-gps">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>MÃ©todo de Pago</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="c-pago" onchange="document.getElementById('c-pago-nota').style.display = this.value==='Combinado'?'block':'none'">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Pago MÃ³vil">Pago MÃ³vil</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Binance">Binance</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Efectivo Divisas">Efectivo Divisas</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Combinado">Pago Combinado</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="c-pago-nota" style="display:none; margin-top:10px;" placeholder="Detalle su pago combinado..."></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group"><label>Notas</label><textarea id="c-notas"></textarea></div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="main-btn" onclick="sendOrder()">Enviar a WhatsApp</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="secondary-btn" onclick="openModal('cart')">â† Volver al carrito</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  const sheetId = '1dHPXGveUToshD1fKRnEf0EwdNnTNE3EuvYTQA3200q8';
Â  Â  Â  Â  const base = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&sheet=Productos`;
Â  Â  Â  Â  let cart = [];

Â  Â  Â  Â  async function loadMenu() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch(base);
Â  Â  Â  Â  Â  Â  Â  Â  const text = await res.text();
Â  Â  Â  Â  Â  Â  Â  Â  const lines = text.split('\n').slice(1);
Â  Â  Â  Â  Â  Â  Â  Â  const menu = {};
Â  Â  Â  Â  Â  Â  Â  Â  lines.forEach(line => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const columns = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(s => s?.replace(/"/g, '').trim());
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const categoria = columns[1];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const nombre = columns[2];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const descripcion = columns[3];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const p1 = columns[4];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const p2 = columns[5];

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!menu[categoria]) menu[categoria] = [];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const opts = [];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (p1 && p1 !== "") opts.push({ label: (p2 && p2 !== "") ? '12oz' : 'Ver', price: parseFloat(p1.replace(',', '.')) });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (p2 && p2 !== "") opts.push({ label: '16oz', price: parseFloat(p2.replace(',', '.')) });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  menu[categoria].push({ categoria, nombre, descripcion, opts });
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  renderMenu(menu);
Â  Â  Â  Â  Â  Â  } catch (e) { console.error(e); }
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderMenu(menu) {
Â  Â  Â  Â  Â  Â  const container = document.getElementById('menu-content');
Â  Â  Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â  Â  Â  for (const cat in menu) {
Â  Â  Â  Â  Â  Â  Â  Â  container.innerHTML += `<h2 class="category-title">${cat}</h2>`;
Â  Â  Â  Â  Â  Â  Â  Â  menu[cat].forEach(p => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const div = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  div.className = 'product';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  div.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="p-info"><h3>${p.nombre}</h3><p>${p.descripcion}</p></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="p-prices">${p.opts.map(o => `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="p-opt" onclick="addToCart('${p.categoria}', '${p.nombre}', '${o.label}', ${o.price})">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small>${o.label === 'Ver' ? '' : o.label}</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>$${o.price.toFixed(2)}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>`).join('')}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(div);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function addToCart(cat, name, size, price) {
Â  Â  Â  Â  Â  Â  const labelSize = size === 'Ver' ? '' : size;
Â  Â  Â  Â  Â  Â  const id = cat + name + labelSize;
Â  Â  Â  Â  Â  Â  const item = cart.find(i => i.id === id);
Â  Â  Â  Â  Â  Â  if (item) item.qty++;
Â  Â  Â  Â  Â  Â  else cart.push({ id, cat, name, size: labelSize, price: parseFloat(price), qty: 1 });
Â  Â  Â  Â  Â  Â  updateUI();
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateUI() {
Â  Â  Â  Â  Â  Â  const total = cart.reduce((s, i) => s + (i.price * i.qty), 0);
Â  Â  Â  Â  Â  Â  const count = cart.reduce((s, i) => s + i.qty, 0);
Â  Â  Â  Â  Â  Â  document.getElementById('view-cart-btn').style.display = count > 0 ? 'block' : 'none';
Â  Â  Â  Â  Â  Â  document.getElementById('btn-qty').innerText = count;
Â  Â  Â  Â  Â  Â  document.getElementById('btn-total').innerText = total.toFixed(2);
Â  Â  Â  Â  Â  Â  document.getElementById('modal-total').innerText = total.toFixed(2);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const list = document.getElementById('cart-list');
Â  Â  Â  Â  Â  Â  list.innerHTML = cart.map((item, index) => `
Â  Â  Â  Â  Â  Â  Â  Â  <div class="cart-item">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><strong>${item.cat}</strong> ${item.name} <small style="color:var(--brand-gold)">${item.size}</small><br>$${item.price.toFixed(2)}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="qty-controls">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="qty-btn" onclick="changeQty(${index}, -1)">-</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>${item.qty}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="qty-btn" onclick="changeQty(${index}, 1)">+</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  `).join('');
Â  Â  Â  Â  }

Â  Â  Â  Â  function changeQty(index, delta) {
Â  Â  Â  Â  Â  Â  cart[index].qty += delta;
Â  Â  Â  Â  Â  Â  if (cart[index].qty <= 0) cart.splice(index, 1);
Â  Â  Â  Â  Â  Â  updateUI();
Â  Â  Â  Â  Â  Â  if (cart.length === 0) closeModal();
Â  Â  Â  Â  }

Â  Â  Â  Â  function toggleDeliveryFields(val) {
Â  Â  Â  Â  Â  Â  document.getElementById('div-dir').style.display = val === 'Delivery' ? 'block' : 'none';
Â  Â  Â  Â  }

Â  Â  Â  Â  function openModal(step) {
Â  Â  Â  Â  Â  Â  document.getElementById('modal-overlay').style.display = 'block';
Â  Â  Â  Â  Â  Â  document.getElementById('step-cart').style.display = step === 'cart' ? 'block' : 'none';
Â  Â  Â  Â  Â  Â  document.getElementById('step-form').style.display = step === 'form' ? 'block' : 'none';
Â  Â  Â  Â  }

Â  Â  Â  Â  function closeModal() { document.getElementById('modal-overlay').style.display = 'none'; }

Â  Â  Â  Â  function getGPS() {
Â  Â  Â  Â  Â  Â  if (navigator.geolocation) {
Â  Â  Â  Â  Â  Â  Â  Â  navigator.geolocation.getCurrentPosition(pos => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('c-gps').value = `https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("ğŸ“ UbicaciÃ³n fijada.");
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function sendOrder() {
Â  Â  Â  Â  Â  Â  const n = document.getElementById('c-nombre').value;
Â  Â  Â  Â  Â  Â  if(!n || !document.getElementById('c-telefono').value) return alert("Nombre y TelÃ©fono son obligatorios.");
Â  Â  Â  Â  Â  Â  const code = 'CF-' + Math.random().toString(36).substr(2, 5).toUpperCase();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let msg = `*PEDIDO #${code} - COOLFFEE*\n`;
Â  Â  Â  Â  Â  Â  msg += `__________________________\n\n`;
Â  Â  Â  Â  Â  Â  msg += `*Cliente:* ${n}\n*CÃ©dula:* ${document.getElementById('c-cedula').value}\n*Tlf:* ${document.getElementById('c-telefono').value}\n`;
Â  Â  Â  Â  Â  Â  msg += `*Entrega:* ${document.getElementById('c-entrega').value}\n`;
Â  Â  Â  Â  Â  Â  if(document.getElementById('c-gps').value) msg += `*GPS:* ${document.getElementById('c-gps').value}\n`;
Â  Â  Â  Â  Â  Â  msg += `*Pago:* ${document.getElementById('c-pago').value}\n`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  msg += `\n*PRODUCTOS:*\n`;
Â  Â  Â  Â  Â  Â  msg += `__________________________\n\n`;
Â  Â  Â  Â  Â  Â  msg += cart.map(i => {
Â  Â  Â  Â  Â  Â  Â  Â  const sub = (i.price * i.qty).toFixed(2);
Â  Â  Â  Â  Â  Â  Â  Â  return `*${i.qty}x ${i.cat.toUpperCase()} ${i.name}* ${i.size ? '['+i.size+']' : ''}\nÂ  _Precio: $${i.price.toFixed(2)} c/u - Subtotal: $${sub}_`;
Â  Â  Â  Â  Â  Â  }).join('\n\n');
Â  Â  Â  Â  Â  Â  msg += `\n__________________________\n\n`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  msg += `*TOTAL A PAGAR: $${document.getElementById('modal-total').innerText}*`;
Â  Â  Â  Â  Â  Â  if(document.getElementById('c-notas').value) msg += `\n\n*Nota:* ${document.getElementById('c-notas').value}`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  window.open(`https://wa.me/584167492934?text=${encodeURIComponent(msg)}`, '_blank');
Â  Â  Â  Â  }

Â  Â  Â  Â  loadMenu();
Â  Â  </script>
</body>
</html>
